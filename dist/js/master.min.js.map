{"version":3,"sources":["application.js","session-service.js","example/ExampleController.js","example-directive.js"],"names":["application","angular","module","$httpProvider","config","$routeProvider","TEMPLATES","when","templateUrl","title","controller","controllerAs","otherwise","redirectTo","constant","service","$rootScope","$location","$http","$q","$timeout","$window","ToolsService","ModalService","timer","self","this","isLoggedIn","loginException","loginData","clearLoginData","sessionData","clearSessionData","clearLoginException","user","JSON","parse","USER","undefined","logout","LOGOUT","login","deferred","defer","resolve","post","SERVICES","success","data","updateTimeout","exception","reject","isDefined","$$search","originalPath","promise","getFBUrl","isUndefined","fbUrl","isSuccess","cancel","location","reload","code","errorMessage","timestamp","delta","Date","now","lastActivity","timeRemaining","$","document","on","e","isEmpty","avatar","expireMethod","openModal","loginMethods","ADMINISTRATIVE","FACEBOOK","INTERACTIVE","MEMBER_EMULATION","PROMO_EMAIL","message","directive","restrict","template"],"mappings":"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","file":"master.min.js","sourcesContent":["/** \n * The application module is the standard module for ALL angular single page applications.\n */\n\nvar application = angular.module('application', ['ngRoute','ngResource','ngSanitize', 'ngMessages'], ['$httpProvider', function($httpProvider) {\n\n\n\n}]);\n\n\napplication.config(['$routeProvider', 'TEMPLATES', function($routeProvider, TEMPLATES) {\n    $routeProvider\n        .when('/example', { \n            templateUrl: TEMPLATES + 'example.html',\n            title: 'Example',\n            controller: 'ExampleController',\n            controllerAs: 'ExampleCtrl'\n        })\n        .otherwise({\n            redirectTo: '/',\n        });\n}]);\n\napplication.constant('TEMPLATES', '/web/templates/');","/**\n * \n */\napplication.service('SessionService', \n\t['$rootScope', '$location', '$http', '$q', '$timeout', '$window', 'ToolsService', 'ModalService', \n\tfunction($rootScope, $location, $http, $q, $timeout, $window, ToolsService, ModalService) {\n\t\n\tvar self = this;\n    var timer;\n\t    \n    self.isLoggedIn = false;\n\tself.loginException = {};\n\t\n\tself.loginData = {};\n\tself.clearLoginData = function(){\n\t\tself.loginData = {};\n\t}\n\t\n\tself.sessionData = {};\n\tself.clearSessionData = function(){\n\t\tself.sessionData = {};\n\t}\n\t\n\tself.loginException = {};\n\tself.clearLoginException = function(){\n\t\tself.loginException = {};\n\t}\n\t\n    $rootScope.user = typeof(USER) !== 'undefined'? JSON.parse(USER) : undefined;\n\t$rootScope.logout = typeof(LOGOUT) !== 'undefined'? JSON.parse(LOGOUT) : undefined;\n\t\n\tself.login = function(){\n\t\tvar deferred = $q.defer();\n\t\tself.clearLoginException();\n\t\tif(!self.isLoggedIn){\n\t    \t$http.post(SERVICES + \"login.php\",self.loginData).success(function(data){\n\t    \t\tif(typeof(data.exception) === \"undefined\"){\n\t    \t\t\tself.sessionData = data;\n\t    \t\t\tself.clearLoginData();\n\t    \t\t\tself.updateTimeout();\n\t    \t\t\tself.isLoggedIn = true;\n\n\t    \t\t\t$rootScope.user = data;\n\t    \t\t\t\n\t    \t\t\tdeferred.resolve();\n\t    \t\t} else {\n\t    \t\t\tself.loginException = data.exception;\n\t    \t\t\tdeferred.reject();\n\t    \t\t}\n\n\t    \t\tif(angular.isDefined($rootScope.logout)){\n\t    \t\t\tdelete $location.$$search.originalPath;\n\t    \t\t}\n\t    \t})\n\t\t} else {\n\t\t\t$rootScope.user = typeof(USER) !== 'undefined'? JSON.parse(USER) : undefined;\n\t\t\tdeferred.resolve();\n\t\t}\n\t\treturn deferred.promise;\n    }\n\t\n\tself.getFBUrl = function(){\n\t\tvar deferred = $q.defer();\n\t\tif(!self.isLoggedIn){\n\t    \t$http.post(SERVICES + \"facebook/get-login-url.php\").success(function(data){\n\t    \t\tif(angular.isUndefined(data.exception)){\n\t    \t\t\t//exposed to root level of service Object\n\t    \t\t\tself.fbUrl = data.fbUrl;\n\t    \t\t\tisSuccess = true;\n\t    \t\t\tdeferred.resolve()\n\t    \t\t} else {\n\t    \t\t\tself.loginException = data.exception;\n\t    \t\t\tdeferred.reject();\n\t    \t\t}\n\t    \t})\n\t\t} else {\n\t\t\tdeferred.resolve();\n\t\t}\n        return deferred.promise;\n    }\n\t\n\tself.logout = function(){\n\t\tvar deferred = $q.defer();\n\t\tif(self.isLoggedIn){\n\t    \t$http.post(SERVICES + \"logout.php\").success(function(data){\t    \n\n\t    \t\tif(typeof(data.exception) === \"undefined\"){\n\t\t    \t\tself.clearSessionData();\n\t\t\t\t\t$timeout.cancel(timer);\n\t\t\t\t\t$window.location.reload();\n\t    \t\t} else {\n\t    \t\t\tswitch(data.exception.code) { \n\t                default:\n\t                    $rootScope.errorMessage = \"We are sorry! Unexpected Service Error.\";\n\t                    break;\n\t    \t\t\t}\n\t    \t\t}\n\t    \t})\n\t    \t[\"finally\"](function() {\n\t    \t\tdeferred.resolve();\n\t        });\n\t\t} else {\n\t\t\tdeferred.resolve();\n\t\t}\n        return deferred.promise;\n\t}\n\t\n    self.updateTimeout = function() {\n        $timeout.cancel(timer);\n        var timestamp = { \"delta\" : Date.now() - self.lastActivity };\n        $http.post(SERVICES + \"user.php\", timestamp).success(function(data){\n            if (typeof(data.exception) === \"undefined\") {\n                if (data.timeRemaining > 0) {\n                    timer = $timeout(function() {\n                            self.updateTimeout();\n                    }, data.timeRemaining);\n\n                } else {\n                \tself.logout();\n                }\n            } else {\n                self.logout();\n            }\n        });\n    };\n\n\tself.lastActivity = Date.now();\n\t$(document).on('click keypress scroll', function(e) {\n      self.lastActivity = Date.now();\n    });\n\n\t\n  if ($rootScope.user) {\n    self.isLoggedIn = true;\n    self.sessionData = $rootScope.user;\n\n    // default image\n    if (ToolsService.isEmpty(self.sessionData.avatar)) {\n      self.sessionData.avatar = \"web/assets/images/user-default-avatar.png\";\n    }\n\n    // If the user is logged in, listen for user activity.\n    self.updateTimeout();\n    \n  } else if($rootScope.logout){\n    // console.log(\"Show \" + $rootScope.logout.expireMethod + \" modal\")\n    if ($rootScope.logout.expireMethod === \"SOFT_TIMEOUT\") {\n      ModalService.openModal(\"web/components/modals/logged-out.php\");\n    }\n  };\n\t\n    self.loginMethods = {\n    \t\"ADMINISTRATIVE\": \"ADMINISTRATIVE\",\n    \t\"FACEBOOK\": \"FACEBOOK\",\n    \t\"INTERACTIVE\": \"INTERACTIVE\",\n    \t\"MEMBER_EMULATION\": \"MEMBER_EMULATION\",\n    \t\"PROMO_EMAIL\": \"PROMO_EMAIL\"\n    }\n    \n}]);\n","application.controller('ExampleController', ['$rootScope', function ($rootScope) {\n\n\tvar vm = this;\n\n\tthis.message = \"Hi from the Example Controller! :)\";\n\n}]);\n","/**\n * \n */\napplication.directive('exampleDirective', [function() {\n    return {\n        restrict: 'A',\n        template: '<div>Example Directive</div>'\n    }\n}]);"],"sourceRoot":"/source/"}